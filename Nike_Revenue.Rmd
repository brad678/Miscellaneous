---
title: "Nike Revenue Forecast"
output: 
  html_document: 
    smart: no
---

### Project details: 

#### Domain: Retail
#### Project: Nike Revenue Forecast
#### Data: Nike_revenue.xlsx

#### Description
- Data has been collected quarterly on Nike's revenue for the fiscal years 1999 through 2008; for instance, data for fiscal year 1999 refers to the time period from June 1, 1998 through May 31, 1999. For validation set, 2009 data has been provided.

#### Case questions
- Plot the data. Which time series components seem to be present in this series? Interpret the chart in practical terms.

#### Part I: Regression
- Build a regression candidate model(s) and use that model(s) to forecast Nike's revenue for the validation set. 
Hint: residual diagnostics might be helpful in identifying potentially good candidate models
- Do the forecasts seem reasonable? Briefly discuss
- What is/are the value(s) of RMSE for the training set? What is/are the value(s) of RMSE for the validation set?

#### Part II: Smoothing methods
- Identify an appropriate smoothing model(s) you should use for Nike's revenue forecasting and discuss why you selected this/these model(s).

#### Part III: Classical time series decomposition
- Perform time series decomposition on Nike sales revenue.

#### Part IV: ARIMA models
- Is the data stationary? How do you know? Is there a way to make non-stationary data stationary? How? Apply these ideas to Nike's revenue data.

#### Final Objective
- Build forecasting models to forecast Nike's revenue for 2010. 
- Prepare a report to summarize your approach(es) and findings. 
- You will need to convey statistical information in written form to those who may not know statistical terminology. 
- Your report is needed as input for managerial decision making in sales, marketing, and company planning.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


### Loading required packages

```{r}

library(forecast)
library(TTR)
library(Metrics)
library(tidyr)
library(dplyr)

```

### Loading the data
### Revenues are provided for fiscal years 1999 to 2009. Here fiscal year means previous year June 1 to current year May 31
### Fiscal year 1999: June 1, 1998 to May 31,1999

```{r}

revenues <- read.csv('Nike_revenue.csv')
str(revenues)

```


### Formatting the data

```{r}

revenues_t <- as.data.frame(t(revenues[,2:5]))
revenues_t



revenues1 <- gather(revenues_t,"quarter","revenues",1:11)
revenues1 <- revenues1[,-1]
revenues1



```


### Creating time series data

```{r}


revenuests <- ts(revenues1,start=c(1999,1),frequency = 4)
revenuests


```

Here:

- 1999 - 2009 are fiscal years
- Qtr1 - June(Prev year)       to August(prev year)
- Qtr2 - September(prev year)  to November(prev year)
- Qtr3 - December(prev year)   to February(current year)                                              
- Qtr4 - March(prev year)      to May(current year)

### Plotting the time series data

```{r}

plot(revenuests)

```

Can infer that:

- There is a upward rising trend
- The revenue is rising and falling at regular intervals of time. We can observe seasonal and cyclical patterns in the data.



### Seasonal trend decompostion


```{r}

seasonaldecom <- stl(revenuests,s.window = "periodic")
seasonaldecom

```

Can infer that:

- Data is divided into seasonal, trend and remainder (unexplained) components
- Seasonal value is repeating itself every quarter (that is same value every Q1, same value every Q2/Q3/Q4)
- Trend is increasing mostly and decreasing in between but overall can find a rising trend from 2221 to 4565 millions (105% increase over a period of 10 years from 1999 to 2009)


### Plotting the Seasonal trend decompostion

```{r}
plot(seasonaldecom)
monthplot(revenuests)

```

Can infer following from seasonal decomposition:

- Can find increase and decrease at regular intervals of time (from seasonal component)
- Can find steady increase in trend over the years. However from 2009 fiscal year Q2 (that is from Sep 2008) onwards the trend is falling
- There is some unexplainedn(remainder) portion too

Can infer following from overall quarterly plot (for all years put together):

- The revenues in all quarters have increased over the years
- The revenues in Q1 and Q4 are higher compared to the revenues in Q2 and Q3. Q2 got least revenues
- The revenues in Q3 and Q4 are decreasing off late (in 2009)


### Part I: Fitting the linear regression model
### Fit a Linear Model with Time Series componenets of Trend and Seasonality
### use Additive if data set has CONSTANT seasonality Variation


```{r}

# Additive
fitlmAdd <- tslm(revenuests ~ trend + season)
summary(fitlmAdd)

cat('\n\nThe accuracy measures are as follows:\n\n')
accuracy(fitlmAdd)

```

Can infer that:

- RMSE for the model is 235.2373


### Predict using linear Additive model

```{r}

pred.fitlmAdd <- predict(fitlmAdd,n.ahead=8,interval = "prediction")
pred.fitlmAdd

forecast(fitlmAdd, h=4)

```






### Fit a Linear Model with Time Series componenets of Trend and Seasonality
### Use Multiplicative if data set has INCREASING or DECREASING Seasonality variation. 
### Multiplicative will become additive if log of data is taken


```{r}

#Multiplicative
fitlmMul <- tslm(revenuests ~ trend * season)
summary(fitlmMul)

accuracy(fitlmMul)

```

 

```{r}

plot(forecast(fitlm, h=4))
#abline(fit.ex3)

```


